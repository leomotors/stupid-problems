\documentclass[11pt,a4paper]{article}

\usepackage{res/style_th}

\begin{document}

\begin{problem}{แบ่งประเทศ}{standard input}{standard output}{1 seconds}{256 megabytes}

ในโลกแห่งนี้ เต็มไปด้วยอารยธรรมที่หลากหลาย เมืองที่เป็นผู้นำ และ เมืองที่เป็นผู้ตาม

คุณกับเพื่อนกำลังเล่นเกม Civilization VI อยู่ แต่แล้วเพื่อนคุณก็ได้มอบข้อเสนอให้คุณแบ่งเมืองให้เขาครึ่งหนึ่งแลกกับเทคนิคในการจีบสาว (จากคนที่มีแฟนแล้ว) คุณซึ่งเป็นคนที่โสดมานานหลายปี จึงไม่มีทางเลือกนอกจากทำตามข้อเสนอของเพื่อนคุณ

ในเมืองแต่ละเมืองจะประกอบไปด้วย เขต $N$ เขต แทนด้วยเลข $(1, 2, \cdots, N)$ แต่สิ่งที่น่าสนใจคือวิธีการที่จะเดินทางจากเมืองใดๆ ไปยังอีกเมืองจะมีวิธีเดียวเสมอ นั่นก็เพราะว่ามีถนนเพียงแค่ $N-1$ เส้น และตามทฤษฎีกราฟ ม.ปลาย ที่เราไม่ได้เรียนมา เมืองนี้จะไม่มีวงวน ซึ่งนั่นก็หมายความว่าเราสามารถแบ่งเมืองให้เป็น 2 เมืองได้ โดยการตัดถนนแค่เส้นเดียว

แต่เพื่อนของคุณนั้นรู้เกี่ยวกับเกมนี้น้อยกว่าคุณ จึงเป็นโอกาสที่คุณจะแอบเนียนเอาเปรียบเพื่อนคุณซักหน่อย เพื่อนของคุณนั้นเชื่อว่ามูลค่าของเมืองนั้น ขึ้นอยู่กับจำนวนเขตเพียงอย่างเดียว แต่แท้จริงแล้ว ถ้าเพื่อนคุณหัดคลิ๊กซักหน่อย ก็จะพบว่าแต่ละเขตมีมูลค่าของมันอยู่

คุณจึงต้องการหาวิธีการแบ่งเมืองที่ให้ 2 เมืองนั้นมีจำนวนเขตเท่ากัน ในกรณที่หารไม่ลงตัว เพื่อนคุณยอมให้คุณมีเมืองมากกว่าได้ไม่เกิน $1$ เมือง

เมื่อได้รับดีลแสนคุ้ม (มั้ง) นี้มาแล้ว คุณก็ต้องคำนวณหาว่าแบ่งแบบไหนเยอะสุด แต่เพื่อไม่ให้ดู $SUS$ คุณจำเป็นที่จะต้องหาออกมาให้ไวที่สุด และนี่คืองานของคุณ ให้คิดซะว่าทำเพื่อให้ได้เทคนิคการจีบสาว

\InputFile

\textbf{บรรทัดแรก} ประกอบด้วยจำนวนเต็ม $N$ ($2 \le N \le 10^6$) แทนจำนวนเขตที่มีอยู่ในเมืองของคุณ \\ 
\textbf{บรรทัดต่อไป} ประกอบด้วยจำนวนเต็ม $N$ จำนวน นั่นคือ $P_i$ ซึ่งแทนมูลค่าของเมืองที่ $i$ ($1 \le i \le N$) และ ($1 \le P_i \le 10^9$) \\
\textbf{อีก $N-1$ บรรทัด} ประกอบด้วยจำนวนเต็ม $u$ และ $v$ แทนว่ามีถนนเชื่อมระหว่างเขต $u$ และ $v$ ระหว่างสองเขตใดๆ จะมีถนนเพียงเส้นเดียวเท่านั้น และทุกเขตเชื่อมถึงกัน

\OutputFile

มี $1$ จำนวน

แสดงมูลค่ารวมในเมืองของคุณที่มากที่สุด

\Scoring
มีชุดทดสอบ $10$ ชุด ชุดละ $10$ คะแนน

$10$ คะแนน: $N \le 10$

$20$ คะแนน: แผนผังเมืองเป็นเส้นตรงเหมือนข้อ $tjunction$ (ทุกๆเขตจะมีถนนเชื่อมไม่เกิน $2$ เส้น)

$20$ คะแนน: $N \le 500$

$10$ คะแนน: $P_i = 1$  $\forall i$  

$40$ คะแนน: ไม่มีเงื่อนไขเพิ่มเติม

\Examples

\begin{example}
\exmp{
8 3 4
1
3
7
7
}{
2
}\exmp{
8 6 4
2
3
6
7
}{
1
}%
\end{example}

อธิบายตัวอย่างที่ $1$

\end{problem}

\end{document}
